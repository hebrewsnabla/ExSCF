#INFO: **** input file is /share/home/srwang/ExSCF/test/pytest/test.py ****
#import phf
from pyscf import gto, scf
#import scipy
#import numpy as np
import sys

from pyphf import util

xyz = 'h2.xyz' #sys.argv[1]
fch = '../test_carlos/test_uhf.fchk' #sys.argv[2]
bas = xyz[:-3] + 'bas'


mf = util.guess_from_fchk(xyz, bas, fch)

mf2 = util.SUHF(mf)
mf2.cut_no = False
mf2.debug = False
mf2.max_cycle = 15
mf2.kernel()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xcluster', release='3.10.0-693.el7.x86_64', version='#1 SMP Thu Jul 6 19:56:57 EDT 2017', machine='x86_64', processor='x86_64')  Threads 16
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Tue Nov 10 19:57:02 2020
PySCF version 1.7.3
PySCF path  /share/apps/Python/Anaconda3-2019/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 2
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr

nuclear repulsion = 0.26458860546
number of shells = 4
number of NR pGTOs = 6
number of NR cGTOs = 4
basis = h2.bas
ecp = {}
CPU time:         1.19


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/ExSCF/test/pytest/tmp5t04m5xe
max_memory 4000 MB (current use 92 MB)
number electrons alpha = 1  beta = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.644800894941738
  alpha nocc = 1  HOMO = -0.248574003043426  LUMO = -0.0900508471637462
  beta  nocc = 1  HOMO = -0.241945730776492  LUMO = -0.09160035062619
cycle= 1 E= -0.90763782954924  delta_E= -0.263  |g|= 0.0146  |ddm|= 0.599
SCF not converged.
SCF energy = -0.90763782954924 after 1 cycles  <S^2> = 6.5933669e-07  2S+1 = 1.0000013


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 0
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/ExSCF/test/pytest/tmp5t04m5xe
max_memory 4000 MB (current use 109 MB)
number electrons alpha = 1  beta = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.99701150589175
  alpha nocc = 1  HOMO = -0.49432997422898  LUMO = 0.12017707328242
  beta  nocc = 1  HOMO = -0.49432997422898  LUMO = 0.120177073282419
SCF not converged.
SCF energy = -0.99701150589175 after 0 cycles  <S^2> = 0.91048114  2S+1 = 2.1545126
