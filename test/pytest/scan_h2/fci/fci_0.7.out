

#INFO: **** input file is /share/home/srwang/ExSCF/test/pytest/scan_h2/scan_fci.py ****
#import phf
from pyscf import lib, fci
#import scipy
import numpy as np
import sys, os, contextlib

from pyphf import util, sudft

#xyz = 'h2.xyz' #sys.argv[1]
fch = 'test_uhf.fchk' #sys.argv[2]
#bas = '../h2.bas'
bas = 'cc-pvtz'

lib.num_threads(16)

for r in np.arange(0.5, 2.55, 0.1):
    output = 'fci/fci_%.1f.out' % r
    os.system("echo '\n' > %s" % output)
    with open(output, 'a', encoding='utf-8') as f:
        with contextlib.redirect_stdout(f):
            xyz = '''H 0.0 0.0 0.0; H 0.0 0.0 %f'''%r
            mf = util.guess_from_fchk(xyz, bas, fch)
            #mf = util.guess(xyz, bas)
            mf.max_cycle = 50
            mf.kernel()
            ci = fci.FCI(mf)
            print('E(FCI) = %15.8f' % ci.kernel()[0])#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc02n18', release='3.10.0-693.el7.x86_64', version='#1 SMP Thu Jul 6 19:56:57 EDT 2017', machine='x86_64', processor='x86_64')  Threads 16
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Tue Nov 24 04:44:58 2020
PySCF version 1.7.5
PySCF path  /share/home/srwang/pyscf-1.7.5/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 2
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 H      0.000000000000   0.000000000000   0.700000000000 AA    0.000000000000   0.000000000000   1.322808287196 Bohr

nuclear repulsion = 0.755967444171429
number of shells = 12
number of NR pGTOs = 32
number of NR cGTOs = 28
basis = cc-pvtz
ecp = {}
CPU time:        12.35


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/ExSCF/test/pytest/scan_h2/tmpyy0yknnx
max_memory 4000 MB (current use 207 MB)
number electrons alpha = 1  beta = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.823356274825295
  alpha nocc = 1  HOMO = -0.568731391355298  LUMO = 0.145787911648173
  beta  nocc = 1  HOMO = -0.575714068470886  LUMO = 0.145700899373507
cycle= 1 E= -1.13106395405129  delta_E= -0.308  |g|= 0.0327  |ddm|= 0.333
SCF not converged.
SCF energy = -1.13106395405129 after 1 cycles  <S^2> = 1.5253886e-05  2S+1 = 1.0000305


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/ExSCF/test/pytest/scan_h2/tmpyy0yknnx
max_memory 4000 MB (current use 207 MB)
number electrons alpha = 1  beta = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.23767093858953
  alpha nocc = 1  HOMO = -0.563521108909957  LUMO = 0.247158214674517
  beta  nocc = 1  HOMO = -0.563521108909958  LUMO = 0.247158214674518
cycle= 1 E= -1.11377050071513  delta_E= 0.124  |g|= 0.0985  |ddm|= 0.185
SCF not converged.
SCF energy = -1.11377050071513 after 1 cycles  <S^2> = 0.088956256  2S+1 = 1.164399


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/ExSCF/test/pytest/scan_h2/tmpyy0yknnx
max_memory 4000 MB (current use 207 MB)
number electrons alpha = 1  beta = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.823356274825295
  alpha nocc = 1  HOMO = -0.568731391355297  LUMO = 0.145787911648172
  beta  nocc = 1  HOMO = -0.575714068470886  LUMO = 0.145700899373505
cycle= 1 E= -1.13106395405129  delta_E= -0.308  |g|= 0.0327  |ddm|= 0.333
  alpha nocc = 1  HOMO = -0.614603337105131  LUMO = 0.16918909798327
  beta  nocc = 1  HOMO = -0.615939604863268  LUMO = 0.16941406659548
cycle= 2 E= -1.13204240101168  delta_E= -0.000978  |g|= 0.00513  |ddm|= 0.0225
  alpha nocc = 1  HOMO = -0.607484613223031  LUMO = 0.17239122603534
  beta  nocc = 1  HOMO = -0.608058828572944  LUMO = 0.172489384049349
cycle= 3 E= -1.1320751226911  delta_E= -3.27e-05  |g|= 0.00068  |ddm|= 0.00593
  alpha nocc = 1  HOMO = -0.607215736081046  LUMO = 0.172658082187958
  beta  nocc = 1  HOMO = -0.607446608910154  LUMO = 0.172696475353738
cycle= 4 E= -1.13207563344188  delta_E= -5.11e-07  |g|= 0.00014  |ddm|= 0.00093
  alpha nocc = 1  HOMO = -0.607331630641355  LUMO = 0.172681524782644
  beta  nocc = 1  HOMO = -0.607336488234321  LUMO = 0.172682461332479
cycle= 5 E= -1.13207566529058  delta_E= -3.18e-08  |g|= 1.41e-05  |ddm|= 0.000207
  alpha nocc = 1  HOMO = -0.607336348887869  LUMO = 0.172676880118303
  beta  nocc = 1  HOMO = -0.607336723238288  LUMO = 0.172676899904622
cycle= 6 E= -1.1320756654816  delta_E= -1.91e-10  |g|= 9.08e-07  |ddm|= 2.37e-05
  alpha nocc = 1  HOMO = -0.607337417672075  LUMO = 0.172677155996333
  beta  nocc = 1  HOMO = -0.607337471314513  LUMO = 0.172677165216465
Extra cycle  E= -1.13207566548209  delta_E= -4.85e-13  |g|= 1.2e-07  |ddm|= 4.19e-07
converged SCF energy = -1.13207566548209  <S^2> = 6.6613381e-15  2S+1 = 1
E(FCI) =     -1.17101460
